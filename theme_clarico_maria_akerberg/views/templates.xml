<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <template id="short_cart_summary_maria" inherit_id="website_sale.short_cart_summary" name="Short Cart right column Maria">
        <xpath expr="//a[@href='/shop/checkout?express=1']" position="replace">
        </xpath>
    </template>

    <template id="maria_product_tabs" inherit_id="theme_clarico.html_content_tabs_ept" name="Maria product_tabs">
        <xpath expr="//t[li[a[@id='nav_tabs_link_specification']]]" position="replace">
        </xpath>
        <xpath expr="//div[@id='nav_tabs_content_specification']" position="replace">
        </xpath>

        <xpath expr="//a[@id='nav_tabs_link_description']" position="replace">
            <a class="nav-link te_tab_mb_nav_link active show" id="nav_tabs_link_description" data-toggle="tab" itemprop="description" href="#nav_tabs_content_description" role="tab" aria-controls="nav_tabs_content_description" aria-selected="true">
                <span class="nav_tab_title">Description</span>
            </a>
        </xpath>

        <xpath expr="//li[a[@id='nav_tabs_link_description']]" position="after">
            <li class="nav-item">
                <a class="nav-link te_tab_mb_nav_link" id="nav_tabs_link_use" data-toggle="tab" href="#nav_tabs_content_use" role="tab" aria-controls="nav_tabs_content_use" aria-selected="false">
                    <span class="nav_tab_title">Use</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link te_tab_mb_nav_link" id="nav_tabs_link_ingredients" data-toggle="tab" href="#nav_tabs_content_ingredients" role="tab" aria-controls="nav_tabs_content_ingredients" aria-selected="false">
                    <span class="nav_tab_title">Ingredients</span>
                </a>
            </li>
        </xpath>

        <xpath expr="//div[@id='nav_tabs_content_description']" position="attributes">
            <attribute name="t-if">True</attribute>
        </xpath>

        <xpath expr="//li[@t-if=&quot;product.website_description or request.env.user.has_group('website.group_website_designer')&quot;]" position="attributes">
            <attribute name="t-if">True</attribute>
        </xpath>


        <xpath expr="//div[div[@t-field='product.website_description']]" position="replace">
            <div class="tab-pane fade show active py-3" id="nav_tabs_content_description" role="tabpanel" aria-labelledby="nav_tabs_link_description">
                <div itemprop="description" t-field="product.product_variant_id.description_webshop" class="col-lg-12 pt-3" id="product_full_description"/>
            </div>

            <div class="tab-pane fade show active py-3" id="nav_tabs_content_use" role="tabpanel" aria-labelledby="nav_tabs_link_use">
                <div itemprop="description" t-field="product.product_variant_id.description_use" class="col-lg-12 pt-3" id="product_full_description"/>
            </div>

            <div class="tab-pane fade show active py-3" id="nav_tabs_content_ingredients" role="tabpanel" aria-labelledby="nav_tabs_link_ingredients">
                <div itemprop="description" t-field="product.product_variant_id.description_ingredients" class="col-lg-12 pt-3" id="product_full_description"/>
            </div>
        </xpath>
    </template>

    <template id="variants_maria_button" inherit_id="sale.variants">
        <xpath expr="//t[@t-if=&quot;ptal.attribute_id.display_type == 'color'&quot;]" position="after">
            <t t-if="ptal.attribute_id.display_type in ['button']">
                <ul t-att-data-attribute_id="ptal.attribute_id.id" t-attf-class="list-unstyled #{'d-none' if single_and_custom else ''}" id="attrs-radio">
                    <t t-foreach="ptal.product_template_value_ids._only_active()" t-as="ptav">
                        <li class="form-group js_attribute_value" style="margin: 7px 7px 0 0;">
                            <label t-attf-class="col-form-label #{'active' if ptav in combination else ''}">
                                <div>
                                    <input type="radio"
                                    t-attf-class="js_variant_change radio_input #{ptal.attribute_id.create_variant}"
                                    t-att-checked="ptav in combination"
                                    t-att-name="'ptal-%s' % ptal.id"
                                    t-att-value="ptav.id"
                                    t-att-data-value_id="ptav.id"
                                    t-att-data-value_name="ptav.name"
                                    t-att-data-attribute_name="ptav.attribute_id.name"
                                    t-att-data-is_custom="ptav.is_custom"
                                    t-att-data-is_single_and_custom="single_and_custom"
                                    />
                                    <div class="radio_input_value">
                                        <span t-field="ptav.name" style="font-weight: lighter;"/>
                                    </div>
                                </div>
                            </label>
                        </li>
                    </t>
                </ul>
            </t>
        </xpath>
    </template>

    <template id="products_attributes_maria" inherit_id="theme_clarico.products_attributes_ept">
        <xpath expr="//t[@t-if=&quot;a.display_type == 'radio'&quot;]" position="attributes">
            <attribute name="t-if">a.display_type in ['radio', 'button']</attribute>
        </xpath>
    </template>

    <template id="portal_my_home_sale" inherit_id="sale.portal_my_home_sale" priority="20">
        <xpath expr="//t[@t-call='portal.portal_docs_entry']" position="replace">
        </xpath>
    </template>

    <template id="payment_sale_note_maria" inherit_id="website_sale.payment_sale_note" name="Maria Akerberg terms">
        <xpath expr="//label/a" position="replace">
            <a data-toggle="modal" data-target="#terms_view" href="">terms &amp; conditions</a>
        </xpath>

        <xpath expr="//div[@class='custom-control custom-checkbox float-right mt-2 oe_accept_cgv_button']" position="after">
            <div class="modal fade" id="terms_view" tabindex='-1'>
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content quick_view_modal">
                        <button type="button" class="quick_close" data-dismiss="modal"
                                aria-label="Close" tabindex="-1">
                        </button>
                        <div class="modal-body">
                            <t t-call="theme_clarico_maria_akerberg.terms"/>
                        </div>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <template id="products_item" inherit_id="website_sale.products_item" name="Products maria">
        <xpath expr="//h6[@class='o_wsale_products_item_title']" position="replace">
            <h6 class="o_wsale_products_item_title product_name" t-att-title="product.name">
                <a itemprop="name" t-att-href="product_href" t-att-content="product.name" t-field="product.name"/>
                <a role="button" t-if="not product.website_published" t-att-href="product_href" class="btn btn-sm btn-danger" title="This product is unpublished.">Unpublished</a>
            </h6>
        </xpath>

        <xpath expr="//div[hasclass('product_price')]" position="replace"></xpath>

        <xpath expr="//h6[hasclass('o_wsale_products_item_title')]" position="after">
            <div id="price_row" class="row m-0 te_p_sm">
                <div class="product_price" itemprop="offers" itemscope="itemscope" itemtype="http://schema.org/Offer">
                    <del t-attf-class="text-danger mr-2 {{'' if combination_info['has_discounted_price'] else 'd-none'}}" style="white-space: nowrap;" t-esc="combination_info['list_price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                    <span t-if="combination_info['price']" t-esc="combination_info['price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                    <span itemprop="price" style="display:none" t-esc="combination_info['price']"/>
                    <span itemprop="priceCurrency" style="display:none" t-esc="website.currency_id.name"/>
                </div>
                <div class="variants_button ml-auto" t-if="combination_info['has_variants']">
                    <span>+ variants</span>
                </div>
            </div>
        </xpath>

        <xpath expr="//h6[hasclass('o_wsale_products_item_title')]/a" position="attributes">
            <attribute name="t-attf-class">
                product_name
                #{'te_2_line' if (website.number_of_product_line == '2') else 'te_3_line' if (website.number_of_product_line == '3') else ''}
            </attribute>
        </xpath>
    </template>

    <template id="products_item_discount_message_maria" inherit_id="theme_clarico.products_item_discount_message" name="Products maria clarico">
        <xpath expr="//span[@t-if=&quot;combination_info['price']&quot;]" position="before">
            <span t-if="combination_info['use_from_price'] and combination_info['has_variants']">from</span>
        </xpath>
    </template>

    <!-- Add agents to my portal view and remove Edit button -->
    <template id="portal_layout_maria" inherit_id="theme_clarico.blank_details" name="Maria Akerberg Agents" priority ="98">
        <xpath expr="//address[1]" position="after">
            <div class="o_portal_my_agents" style="margin-top: 10px;" t-if="user_id.partner_id.agent_ids and len(user_id.partner_id.agent_ids) == 1">
                <h4>Agents</h4>
                <hr class="mt-1 mb-0"/>
            <t t-foreach="user_id.partner_id.agent_ids" t-as="agent">
                <address class="mb-0" itemscope="itemscope" itemtype="http://schema.org/Organization">
                    <div>
                        <span itemprop="name" t-esc="agent.name"></span>
                    </div>
                    <div itemprop="address" itemscope="itemscope" itemtype="http://schema.org/PostalAddress">
                        <div class="d-flex align-items-baseline">
                            <i class="fa fa-map-marker fa-fw" role="img" aria-label="Adress" title="Adress"></i>
                            <span class="w-100 o_force_ltr d-block" itemprop="streetAddress" >
                            <t t-esc="agent.street" />
                            <br />
                            <t t-esc="agent.city" />&amp;nbsp;<t t-esc="agent.zip" />
                            </span>
                        </div>
                        <div><i class="fa fa-phone fa-fw" role="img" aria-label="Telefon" title="Telefon"></i> <span class="o_force_ltr" itemprop="telephone" t-esc="agent.phone"></span></div>
                        <div><i class="fa fa-envelope fa-fw" role="img" aria-label="E-post" title="E-post"></i> <span><a t-att-href="'mailto: %s' % agent.email" itemprop="email" t-esc="agent.email"></a></span></div>
                    </div>
                </address>
            </t>
            </div>
        </xpath>

    <xpath expr="//a" position="replace">
    </xpath>
    </template>

    <!-- Remove Account Security from My Account view -->
    <template id="portal_layout" inherit_id="portal.portal_layout">
        <xpath expr="//div[contains(@class,'o_portal_my_security')]" position="replace">
        </xpath>
    </template>

    <template id="sale_order_portal_templates" inherit_id="sale.sale_order_portal_template">
        <xpath expr="//div[hasclass('o_portal_sale_sidebar')]/div[@id='quote_content']/div[@id='sale_order_communication']" position="attributes">
            <attribute name="style">display: none !important;</attribute>
        </xpath>
    </template>

    <template id="invoice_order_portal_templates" inherit_id="account.portal_invoice_page">
        <xpath expr="//div[hasclass('o_portal_invoice_sidebar')]/div[@id='invoice_content']/div[@id='invoice_communication']" position="attributes">
            <attribute name="style">display: none !important;</attribute>
        </xpath>
    </template>

    <template id="accessories" inherit_id="theme_clarico.product_ept" name="Maria Product accessories">
        <xpath expr="//div[@t-if=&quot;product.accessory_product_ids&quot;]//img" position="attributes">
            <attribute name="t-attf-data-src">/web/image/product.product/#{alt_product.id}/image_512</attribute>
        </xpath>
        <xpath expr="//div[@t-if=&quot;product.accessory_product_ids&quot;]//a" position="attributes">
            <attribute name="t-attf-href">/shop/product/#{ slug(alt_product.product_tmpl_id) }#{ '#attr=' + str(alt_product.product_template_attribute_value_ids[0].id) if alt_product.product_template_attribute_value_ids else '' }</attribute>
        </xpath>
        <xpath expr="//div[@t-if=&quot;product.accessory_product_ids&quot;]//span[@t-att-title='alt_product.name']" position="attributes">
            <attribute name="t-field">alt_product.variant_name</attribute>
            <attribute name="t-att-title">alt_product.variant_name</attribute>
        </xpath>
        <xpath expr="//p[@t-field='product.description_sale']" position="replace"/>
    </template>

    <template id="sale_order_portal_templates" inherit_id="sale.sale_order_portal_template">
        <xpath expr="//div[hasclass('o_portal_sale_sidebar')]/div[@id='quote_content']/div[@id='sale_order_communication']" position="attributes">
            <attribute name="style">display: none !important;</attribute>
        </xpath>
    </template>

    <template id="invoice_order_portal_templates" inherit_id="account.portal_invoice_page">
        <xpath expr="//div[hasclass('o_portal_invoice_sidebar')]/div[@id='invoice_content']/div[@id='invoice_communication']" position="attributes">
            <attribute name="style">display: none !important;</attribute>
        </xpath>
    </template>

    <!-- Add taxes to the shipping cost in the Checkout view -->
    <template id="shop_shipping_tax" inherit_id="website_sale_delivery.payment_delivery_methods" name="Delivery taxes">
        <xpath expr="//t[starts-with(@t-esc,'delivery.rate_shipment')]" position="replace">
            <t t-esc="delivery.rate_shipment(website_sale_order)['price_tax'] if delivery.free_over else delivery.fixed_price" t-options="{&quot;widget&quot;: &quot;monetary&quot;,                            &quot;from_currency&quot;: website_sale_order.currency_id if delivery.free_over else delivery.product_id.company_id.currency_id or website_sale_order.company_id.currency_id,                            &quot;display_currency&quot;: website_sale_order.currency_id}"/>
        </xpath>
    </template>

    <template id="cart_noordersubtotal" inherit_id="website_sale.total" name="Remove subtotal">
        <xpath expr="//tr[@id='order_total_untaxed']" position="replace">
        </xpath>
    </template>

    <!-- Remove Invoices and Delivery orders from Sale order view in the customer portal -->
    <template id="sale_order_portal_content" inherit_id="sale.sale_order_portal_content">
        <xpath expr="//t[@t-set='invoices']" position="attributes">
            <attribute name="t-value">0</attribute>
        </xpath>
    </template>

    <template id="sale_order_stock" inherit_id="sale_stock.sale_order_portal_content_inherit_sale_stock">
        <xpath expr="//t[@t-if='sale_order.picking_ids']" position="replace">
        </xpath>
    </template>

    <!-- Remove the download-button from the Sale order view in the customer portal -->
    <template id="template_id" inherit_id="sale.sale_order_portal_template" name="template_name">
        <xpath expr="//div[contains(@class,'o_download_pdf')]/div" position="replace">
        </xpath>
    </template>

</odoo>
